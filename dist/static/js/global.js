function pageReady(t,e){var n="createTouch"in document;window.supportTouch=n;var o=navigator.userAgent,a=!1;/AppleWebKit\/\d+\.\d+/.test(o)&&(a=!0),window.isWebkit=a;var i=!1;/Android (\d+\.\d+)/.test(o)&&(i=!0),window.isAndroid=i;var r=!1,c=!1,p=!1;/MicroMessenger/.test(o)?r=!0:/Qzone/.test(o)?c=!0:/QQ\/\d+\.\d+\.\d+\.\d+/.test(o)&&(p=!0),window.isInWechat=r,window.isInMqzone=c,window.isInMqq=p,window.baseUrl=["http://",location.host,location.pathname.substring(0,location.pathname.lastIndexOf("/")+1)].join(""),window.onorientationchange=function(){pageResize(e)},window.onresize=function(){pageResize(e)},pageResize(e),t&&t()}function pageResize(t){if(window.supportTouch||window.isWebkit){var e=$("#wrapperOuter"),n=e.width(),o=e.height(),a=n/o,i=n,r=$(".wrapper-inner");if(a>.622){i=.622*o;var c=Math.round(100*i/n).toFixed(2);r.css("width",[c,"%"].join("")),r.css("left",[.5*(100-c),"%"].join(""))}else r.css("width","100%"),r.css("left","0");window.phoneScale=i/320,document.body.style.fontSize=[16*window.phoneScale,"px"].join("")}else document.getElementById("wrapperOuter").style.width="640px",document.getElementById("wrapperOuter").style.left="50%",document.getElementById("wrapperOuter").style.marginLeft="-320px",window.phoneScale=2,document.body.style.fontSize=[16*window.phoneScale,"px"].join("");t&&window.setTimeout(t,0)}function pageGetParam(t){var e=window.location.search;if(e.length>0){var n=e.indexOf("?");if(n>=0){var o=(e=e.substr(n+1)).split("&");for(var a in o){var i=o[a].split("=");if(i.length>=2)if(i[0]==t)return decodeURIComponent(i[1])}}}return""}function pageGetCookie(t){if(document.cookie.length>0){var e=document.cookie.split(";");for(var n in e){var o=e[n].split("=");if(o.length>=2)if(o[0].trim()==t)return decodeURIComponent(o[1])}}return""}function pageSetCookie(t,e,n){document.cookie=n?t+"="+encodeURIComponent(e)+"; domain="+n+"; path=/":t+"="+encodeURIComponent(e)}function pageLoadScript(t,e){var n=document.createElement("script");n.onload=n.onreadystatechange=e,n.type="text/javascript",n.src=t,document.body.appendChild(n)}function pageRecordPV(t){t||(t=location.pathname),"function"==typeof pgvMain?pgvMain({virtualDomain:"tu.qq.com",virtualURL:t}):pageLoadScript("http://pingjs.qq.com/tcss.ping.js",function(){"function"==typeof pgvMain&&pgvMain({virtualDomain:"tu.qq.com",virtualURL:t})})}function pageRecordClick(t){"function"==typeof pgvSendClick?pgvSendClick({virtualDomain:"tu.qq.com",hottag:t}):pageLoadScript("http://pingjs.qq.com/tcss.ping.js",function(){"function"==typeof pgvSendClick&&pgvSendClick({virtualDomain:"tu.qq.com",hottag:t})})}function preventEventPropagation(t){var e=t||window.event;return e&&(e.preventDefault(),e.stopPropagation()),!1}function authorizeByPtlogin(){var t=["http://ui.ptlogin2.qq.com/cgi-bin/login?style=8&appid=549000930&hln_css=",encodeURIComponent(window.baseUrl+"res/logo.png"),"&s_url=",encodeURIComponent(window.baseUrl+"ptCallback.php")].join("");location.href=t}function authorizeByWechatRecirect(){var t=Math.random();pageSetCookie("wechatState",t,"qq.com");var e=["https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx4893740d2e6856a6&redirect_uri=",encodeURIComponent("http://tu.qq.com/websites/Christmas2015/wxCallback.php"),"&response_type=code&scope=snsapi_login&state=",t,"#wechat_redirect"].join("");location.href=e}function sharePageByShuoshuoApi(shareData,shareUrl){loadingStart("正在分享");var shareTitle=$("meta[name=description]").attr("content"),shareDesc=document.title,getParamStr="";window.p_uin&&window.p_skey&&(getParamStr=["?u=o",window.p_uin,"&k=",encodeURIComponent(window.p_skey)].join(""));var _Callback=function(data){if(data.filemd5&&data.filelen){var _Callback=function(t){if(t.length>0){var e=t[0].picinfo;e.content=[shareTitle,shareUrl].join(" "),e.sourceName="天天P图",e.sourceUrl=shareUrl,$.ajax({url:"http://tu.qq.com/websites/Christmas2015/api/qzonePublishShuoshuo.php"+getParamStr,type:"POST",data:e,dataType:"json",timeout:15e3,success:function(t,e){0==t.data.ret?loadingStart("发表说说成功",!0,"http://res.tu.qq.com/assets/opchristmas2015_img/icon-succ.png"):loadingStart(t.data.msg||"发表说说失败..."+JSON.stringify(t),!0)},error:function(t,e,n){loadingStart(n,!0)}})}else loadingStart(t.msg||"发表说说失败.."+JSON.stringify(t),!0)};$.ajax({url:"http://tu.qq.com/websites/Christmas2015/api/qzonePostuploadPicture.php"+getParamStr,type:"POST",data:data,dataType:"text",timeout:15e3,success:function(data,textStatus){eval(data)},error:function(t,e,n){loadingStart(n,!0)}})}else loadingStart(data.msg||"发表说说失败."+JSON.stringify(data),!0)};$.ajax({url:"http://tu.qq.com/websites/Christmas2015/api/qzonePreuploadPicture.php"+getParamStr,type:"POST",data:shareData,dataType:"text",timeout:15e3,success:function(data,textStatus){eval(data)},error:function(t,e,n){loadingStart(n,!0)}})}function sharePageByQZoneApi(t,e){loadingStart("正在分享");var n=$("meta[name=description]").attr("content"),o=document.title,a=pageGetParam("sid")||pageGetCookie("sid");$.ajax({url:"api/shareQZone.php",type:"POST",data:{title:n,summary:o,content:o,imageUrl:t,url:e,sid:a},dataType:"json",timeout:15e3,success:function(t,e){"success"!=e||200!=t.ret?loadingStart("分享空间失败",!0):loadingStart("分享空间成功",!0)},error:function(t,e,n){loadingStart(n,!0)}})}function sharePageByQZoneRedirect(t,e){var n=$("meta[name=description]").attr("content"),o=document.title,a=pageGetParam("sid")||pageGetCookie("sid"),i=["title="+encodeURIComponent(n),"summary="+encodeURIComponent(o),"desc="+encodeURIComponent(o),"imageUrl="+encodeURIComponent(t),"url="+encodeURIComponent(e),"successUrl="+encodeURIComponent(e),"failUrl="+encodeURIComponent(e),"callbackUrl="+encodeURIComponent(e),"sid="+encodeURIComponent(a)];window.location.href="http://openmobile.qq.com/api/check2?page=qzshare.html&loginpage=loginindex.html&logintype=qzone&"+i.join("&")}function launchApp(t,e,n,o){window.isInMqzone?"object"==typeof mqq?launchAppInMQzone(t,e,n,o):pageLoadScript("http://qzs.qq.com/qzone/phone/m/v4/widget/mobile/jsbridge.js",function(){launchAppInMQzone(t,e,n,o)}):launchAppInMBrowser(t,e,n,o)}function launchAppInMQzone(t,e,n,o){if(mqq.support("mqq.ui.openUrl")){var a=new Date;mqq.invoke("ui","openUrl",{url:t,target:2}),window.setTimeout(function(){new Date-a>=1e3||(n&&n.length>0&&window.alert(n),e&&e.length>0&&(o?window.location.replace(e):window.location=e))},800)}else launchAppInMBrowser(t,e,n,o)}function launchAppInMBrowser(t,e,n,o){if(window.supportTouch){var a=new Date;window.location=t,window.setTimeout(function(){new Date-a>=1e3||(n&&n.length>0&&window.alert(n),e&&e.length>0&&(o?window.location.replace(e):window.location=e))},800)}else e&&e.length>0&&(o?window.location.replace(e):window.location=e)}function distanceBetweenPoints(t,e){var n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)}function angleBetweenPoints(t,e){return e.y>t.y?e.x>t.x?Math.atan((e.y-t.y)/(e.x-t.x)):e.x<t.x?Math.PI-Math.atan((e.y-t.y)/(t.x-e.x)):.5*Math.PI:e.y<t.y?e.x>t.x?2*Math.PI-Math.atan((t.y-e.y)/(e.x-t.x)):e.x<t.x?Math.PI+Math.atan((t.y-e.y)/(t.x-e.x)):1.5*Math.PI:e.x>=t.x?0:Math.PI}